# ZCF Project Initialization Skill

项目 AI 上下文初始化，生成/更新根级与模块级 CLAUDE.md 索引文件。

## 功能描述

自动为项目创建或更新 AI 辅助开发所需的上下文文档，包括：
- 根级 CLAUDE.md：项目整体指导
- 模块级 CLAUDE.md：各子模块详细说明

---

## 使用方式

### 新项目初始化
```
你：/zcf:init-project

Claude：正在初始化项目上下文...
[扫描项目结构，生成 CLAUDE.md]
```

### 更新现有文档
```
你：/zcf:init-project --update

Claude：正在更新项目文档...
[对比现有文档，增量更新]
```

---

## 生成的文档结构

### 根级 CLAUDE.md

```markdown
# [项目名称] - AI 开发指南

## 项目概述
[项目简介、目标、技术栈]

## 架构设计
[目录结构、模块关系]

## 开发规范
[编码规范、文件命名、约束要求]

## 开发指南
[常用命令、开发流程]

## 架构约束
[硬性指标、设计原则]
```

### 模块级 CLAUDE.md

```markdown
# [模块名称] 模块指南

## 模块职责
[单一职责描述]

## 接口定义
[API、函数、类接口]

## 数据模型
[实体关系]

## 依赖关系
[依赖的其他模块]

## 使用示例
[代码示例]
```

---

## 自动化分析内容

### 1. 技术栈识别
- Python 版本
- Web 框架（FastAPI/Flask/Django）
- 数据库（PostgreSQL/MySQL/MongoDB）
- 异步框架（asyncio/aiohttp）

### 2. 架构分析
- 项目结构模式（分层架构/Clean Architecture/洋葱架构）
- 依赖关系图
- 数据流向

### 3. 代码规范
- 现有编码风格
- 命名约定
- 注释语言

### 4. 约束检查
- 文件行数统计
- 文件夹文件数量
- 模块复杂度分析

---

## 输出内容

### 诊断报告
```
📊 项目分析报告

技术栈：
- 框架：FastAPI 0.104+
- Python：3.11+
- 异步：支持

架构模式：分层架构
├── api/         # 路由层
├── services/    # 业务逻辑层
├── models/      # 数据模型层
└── schemas/     # 数据传输层

代码质量：
✓ 平均文件行数：45 行
✓ 文件夹结构：清晰
⚠️ 缺少测试文件
⚠️ 缺少类型注解

建议：
1. 添加 pytest 测试框架
2. 完善类型注解
3. 添加 API 文档
```

### 生成文档
- `CLAUDE.md`（根级）
- `app/CLAUDE.md`（应用模块）
- `app/api/CLAUDE.md`（API 模块）
- ...

---

## 配置选项

### 分析深度
- `--quick`：快速扫描，仅生成基础文档
- `--full`：完整分析，包含详细指标（默认）
- `--deep`：深度分析，包含代码质量报告

### 输出格式
- `--markdown`：Markdown 格式（默认）
- `--json`：JSON 格式，便于工具处理
- `--tree`：树状结构可视化

---

## 示例输出

```
你：/zcf:init-project

Claude：🔍 正在分析项目...

扫描目录结构...
✓ 识别 12 个 Python 文件
✓ 检测到 FastAPI 框架
✓ 发现 3 个 API 路由

分析代码质量...
✓ 平均文件行数：67（限制：200）
✓ 模块职责清晰
⚠️ 缺少错误处理
⚠️ 测试覆盖率：0%

生成文档...
✓ 创建 CLAUDE.md（根级）
✓ 创建 app/CLAUDE.md
✓ 创建 app/api/CLAUDE.md

📋 项目初始化完成！

当前状态：
- 技术栈：FastAPI + PostgreSQL + Redis
- 架构：分层架构
- 约束：Python < 200 行/文件
- 进度：框架搭建完成，待开发业务功能

下一步建议：
1. 实现用户认证模块
2. 添加数据库迁移
3. 编写单元测试
```

---

## 智能更新

### 增量检测
当项目结构发生变化时，自动更新相关文档：
- 新增模块 → 创建对应 CLAUDE.md
- 修改接口 → 更新 API 文档
- 变更规范 → 更新约束说明

### 版本对比
```
你：/zcf:init-project --diff

Claude：变更检测：
+ 新增：app/api/auth.py（认证模块）
- 删除：app/utils.py（已废弃）
~ 修改：app/main.py（添加 CORS 配置）

是否更新文档？[Y/n]
```

---

## 最佳实践

1. **项目启动时**：首先运行 `/zcf:init-project`
2. **添加模块后**：重新运行以更新文档
3. **定期更新**：保持文档与代码同步
4. **团队协作**：将生成的文档纳入版本控制

---

## 注意事项

- 生成的文档是 AI 辅助的起点，可根据需要手动调整
- 敏感信息（密钥、密码）不会被记录
- 保持文档简洁，避免过度详细
